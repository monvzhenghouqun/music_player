<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MureFlow - 个性化音乐播放平台 </title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="src/css/style.css">
    <link rel="stylesheet" href="src/css/theme_other.css">
    
</head>

<body class="bg-slate-900 text-white font-sans h-screen flex flex-col overflow-hidden">

    <div id="full-player" class="fixed inset-0 bg-slate-950 z-[100] transition-all duration-700 translate-y-full flex flex-col overflow-hidden pointer-events-none">
        <canvas id="particle-canvas" class="absolute inset-0 opacity-30"></canvas>
        
        <div class="relative h-20 flex items-center px-8 z-10">
            <button onclick="Player.toggleFullPlayer()" class="w-12 h-12 flex items-center justify-center rounded-full hover:bg-white/10 transition">
                <i class="fa-solid fa-chevron-down text-2xl text-slate-400"></i>
            </button>
        </div>

        <div class="relative flex-1 flex items-center justify-around px-20 z-10">
            <div class="w-1/2 flex justify-center items-center">
                <div class="relative w-[450px] h-[450px] group">
                    <div class="absolute inset-0 bg-black rounded-full border-[12px] border-slate-800 shadow-[0_0_50px_rgba(0,0,0,0.8)]"></div>
                    <img id="fp-cover" src="" class="absolute inset-[65px] w-[320px] h-[320px] rounded-full object-cover animate-spin-slow shadow-inner" style="animation-play-state: paused;">
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-8 h-8 bg-slate-900 rounded-full border-4 border-slate-800 z-20"></div>
                </div>
            </div>

            <div class="w-1/3 h-[550px] flex flex-col">
                <div class="mb-8">
                    <h1 id="fp-title" class="text-5xl font-bold mb-4 truncate text-white">等待播放</h1>
                    <div id="fp-meta" class="flex items-center gap-3 text-lg">
                        <span id="fp-artist" class="text-indigo-400 font-medium">--</span>
                        <span class="text-slate-700">|</span>
                        <span id="fp-album" class="text-slate-400">--</span>
                    </div>
                    <div id="fp-playlist-info" class="mt-2 text-sm text-slate-500">
                        来自歌单：<span id="fp-playlist-name">--</span>
                    </div>
                </div>
                
                <div class="flex-1 bg-white/5 rounded-3xl p-10 backdrop-blur-xl border border-white/5 overflow-y-auto no-scrollbar lyrics-mask">
                    <div id="fp-lyrics-content" class="space-y-6 text-slate-400 text-xl text-center">
                        <p>MuseFlow 智能内核已就绪</p>
                        <p class="text-white font-bold text-2xl">请选择一首动听的音乐</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="fp-control-bar" class="relative h-56 px-16 pb-12 flex flex-col items-center justify-end gap-8 z-10 bg-gradient-to-t from-black/80 via-black/40 to-transparent">
    
        <div class="w-full max-w-5xl flex items-center gap-5 mb-2">
            <span id="fp-current" class="text-[10px] text-slate-500 font-mono w-10 text-right">00:00</span>
            <div id="fp-progress-container" class="flex-1 h-1 bg-white/10 rounded-full cursor-pointer relative group">
                <div id="fp-progress" class="absolute h-full bg-indigo-500 w-0 rounded-full transition-all duration-100 shadow-[0_0_12px_rgba(99,102,241,0.5)]">
                    <div class="absolute right-0 top-1/2 -translate-y-1/2 w-3 h-3 bg-white rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform border-[3px] border-indigo-500"></div>
                </div>
            </div>
            <span id="fp-duration" class="text-[10px] text-slate-500 font-mono w-10">00:00</span>
        </div>
        
        <div class="w-full max-w-6xl flex items-center justify-between px-4">
            
            <!-- <div class="flex items-center gap-10 w-1/4">
                <button class="text-slate-500 hover:text-red-500 transition-all active:scale-90" title="喜欢">
                    <i class="fa-regular fa-heart text-base"></i>
                </button>
                <button class="text-slate-500 hover:text-indigo-400 transition-all" title="播放模式">
                    <i class="fa-solid fa-shuffle text-xs"></i>
                </button>
            </div>

            <div class="flex items-center gap-10">
                <button class="text-slate-500 hover:text-white text-xl transition-all active:scale-90"><i class="fa-solid fa-backward-step"></i></button>
                
                <button onclick="Player.toggle()" class="w-16 h-16 bg-indigo-600 text-white rounded-full flex items-center justify-center hover:scale-105 hover:bg-indigo-500 active:scale-95 transition-all shadow-[0_8px_25px_rgba(79,70,229,0.4)]">
                    <i id="fp-play-icon" class="fa-solid fa-play text-2xl ml-1"></i>
                </button>
                
                <button class="text-slate-500 hover:text-white text-xl transition-all active:scale-90"><i class="fa-solid fa-forward-step"></i></button>
            </div> -->

            <div class="flex items-center gap-10 w-1/4">
                <button onclick="Player.toggleLike()" class="player-action-btn btn-like text-slate-500 hover:text-red-500 transition-all active:scale-90" title="喜欢">
                    <i class="fa-regular fa-heart text-base"></i>
                </button>
                <button onclick="Player.toggleMode()" class="player-action-btn btn-mode text-slate-500 hover:text-indigo-400 transition-all" title="播放模式">
                    <!-- <i class="fa-solid fa-shuffle text-xs"></i> -->
                    <i class="fa-solid fa-shuffle text-xs"></i>
                </button>
            </div>

            <div class="flex items-center gap-10">
                <button class="btn-prev text-slate-500 hover:text-white text-xl transition-all active:scale-90">
                    <i class="fa-solid fa-backward-step"></i>
                </button>
                
                <button onclick="Player.toggle()" class="btn-toggle w-16 h-16 bg-indigo-600 text-white rounded-full flex items-center justify-center hover:scale-105 hover:bg-indigo-500 active:scale-95 transition-all shadow-[0_8px_25px_rgba(79,70,229,0.4)]">
                    <i id="fp-play-icon" class="fa-solid fa-play text-2xl ml-1"></i>
                </button>
                
                <button class="btn-next text-slate-500 hover:text-white text-xl transition-all active:scale-90">
                    <i class="fa-solid fa-forward-step"></i>
                </button>
            </div>

            <div class="flex items-center justify-end gap-10 w-1/4">
                <!-- <div class="flex items-center gap-3 group">
                    <i class="fa-solid fa-volume-low text-[10px] text-slate-500 group-hover:text-white"></i>
                    <div class="w-20 h-0.5 bg-white/10 rounded-full cursor-pointer relative overflow-hidden">
                        <div class="absolute h-full bg-indigo-500 w-2/3"></div>
                    </div>
                </div> -->
                <!-- <button class="text-slate-500 hover:text-white transition-all">
                    <i class="fa-solid fa-list-ul text-xs"></i>
                </button> -->
                <!-- <div class="flex items-center gap-3 group">
                    <button onclick="Player.toggleMute()" class="flex items-center justify-center">
                        <i id="p-volume-icon" class="fa-solid fa-volume-low text-slate-500 text-lg group-hover:text-indigo-500 transition-all"></i>
                    </button>
                    <div id="volume-container" class="w-24 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full cursor-pointer relative overflow-hidden">
                        <div id="volume-progress" class="absolute h-full bg-slate-400 w-2/3 group-hover:bg-indigo-400 transition-colors"></div>
                    </div>
                </div> -->

                <div class="flex items-center gap-3 group">
                    <button onclick="Player.toggleMute()" class="flex items-center justify-center p-1">
                        <i id="p-volume-icon" class="fa-solid fa-volume-low text-slate-500 text-xl group-hover:text-indigo-500 transition-all"></i>
                    </button>
                    <div id="fp-volume-container" class="w-24 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full cursor-pointer relative overflow-hidden">
                        <div id="fp-volume-progress" class="absolute h-full bg-slate-400 w-2/3 group-hover:bg-indigo-400 transition-colors"></div>
                    </div>
                </div>

                <button onclick="Player.toggleQueue()" class="text-slate-500 hover:text-white transition">
                    <i class="fa-solid fa-list-ul"></i>
                </button>
            </div>
        </div>
        </div>
    </div>

    <!--  -->
    <div id="queue-drawer" class="fixed right-0 top-0 h-full w-80 bg-slate-900/95 backdrop-blur-xl border-l border-white/10 z-[200] transform translate-x-full transition-transform duration-300 flex flex-col shadow-2xl">
    
    
    <div class="p-6 border-b border-white/5 flex justify-between items-center">
        <div>
            <h3 class="text-xl font-bold text-white">播放队列</h3>
            <p id="queue-count" class="text-xs text-slate-500 mt-1">0 首歌曲</p>
        </div>
        <button onclick="Player.toggleQueue()" class="text-slate-400 hover:text-white transition">
            <i class="fa-solid fa-xmark text-xl"></i>
        </button>
    </div>

    <div class="flex-1 overflow-y-auto p-2" id="queue-list-container">
        </div>
    </div>

    <div id="queue-overlay" onclick="Player.toggleQueue()" class="fixed inset-0 bg-black/50 z-[190] opacity-0 pointer-events-none transition-opacity duration-300"></div>

    <!--  -->

    <nav class="h-16 bg-slate-900/95 border-b border-white/5 flex items-center px-6 shrink-0 z-20">
        <div class="flex items-center gap-8 text-sm font-medium">
            <div class="flex items-center gap-2 font-bold text-xl mr-4">
                <i class="fa-solid fa-music text-indigo-500"></i> MuseFlow
            </div>
            <button onclick="loadPage('home')" class="hover:text-indigo-400 transition">发现</button>
            <button onclick="loadPage('rank')" class="hover:text-indigo-400 transition">排行榜</button>
            <button onclick="loadPage('user')" class="hover:text-indigo-400 transition">我的</button>
            <button onclick="loadPage('about')" class="hover:text-indigo-400 transition">关于</button>
        </div>
    
        <div class="flex-1"></div>
        <div class="flex items-center gap-4">
            <div class="relative w-64">
                <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-xs"></i>
                <input type="text" placeholder="搜索音乐、歌手..." 
                    class="dynamic-input w-full rounded-full py-1.5 pl-9 pr-4 text-xs focus:outline-none focus:border-indigo-500/50 transition-all shadow-sm">
            </div>
            <button onclick="toggleSettings()" 
                    class="dynamic-button-primary w-8 h-8 rounded-full flex items-center justify-center border border-white/10 hover:scale-110 transition text-white shadow-md">
                <i class="fa-solid fa-user text-[10px]"></i>
            </button>
        </div>
    </nav>

    <main id="dynamic-content" class="flex-1 overflow-y-auto relative scroll-smooth"></main>

    <div id="player-bar" class="h-24 glass-panel border-t border-white/5 flex items-center justify-between px-6 shrink-0 z-50">
    <div class="flex items-center gap-4 w-1/3">
        <div class="relative group cursor-pointer shrink-0">
            <img id="p-cover" src="" class="w-14 h-14 dynamic-input rounded-lg object-cover shadow-lg group-hover:brightness-50 transition-all hidden">
            <i class="fa-solid fa-chevron-up absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity text-white pointer-events-none"></i>
        </div>
        <div class="overflow-hidden min-w-[120px]">
            <div id="p-title" class="text-sm font-bold truncate">等待播放</div>
            <div id="p-artist" class="text-xs text-slate-500 truncate mt-1">--</div>
        </div>
        <!--  -->
        <!-- <div class="flex gap-3 ml-2">
            <button class="text-slate-500 hover:text-red-500 transition-all active:scale-90"><i class="fa-regular fa-heart text-lg"></i></button>
            <button class="text-slate-500 hover:text-indigo-400 transition-all active:scale-90"><i class="fa-solid fa-shuffle text-base"></i></button>
        </div> -->
        <div class="flex gap-3 ml-2">
            <button onclick="Player.toggleLike()" class="btn-like text-slate-500 hover:text-red-500 transition-all active:scale-90">
                <i class="fa-regular fa-heart text-lg"></i>
            </button>
            <button onclick="Player.toggleMode()" class="btn-mode text-slate-500 hover:text-indigo-400 transition-all active:scale-90">
                <i class="fa-solid fa-shuffle text-base"></i>
                <!-- <i class="fa-solid fa-shuffle fa-1 fa-arrow-right-long text-base"></i> -->
            </button>
        </div>
    </div>

    <div class="flex flex-col items-center w-1/3 max-w-xl">
        <!-- <div class="flex items-center gap-8 mb-2">
            <button class="player-ctrl-btn"><i class="fa-solid fa-backward-step text-lg"></i></button>
            <button onclick="Player.toggle()" class="w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center hover:scale-110 active:scale-95 transition-all shadow-lg">
                <i id="p-btn-icon" class="fa-solid fa-play ml-0.5 text-lg"></i>
            </button>
            <button class="player-ctrl-btn"><i class="fa-solid fa-forward-step text-lg"></i></button>
        </div> -->

        <div class="flex items-center gap-8 mb-2">
            <button class="btn-prev player-ctrl-btn">
                <i class="fa-solid fa-backward-step text-lg"></i>
            </button>
            <button onclick="Player.toggle()" class="btn-toggle w-10 h-10 bg-indigo-600 text-white rounded-full flex items-center justify-center hover:scale-110 active:scale-95 transition-all shadow-lg">
                <i id="p-btn-icon" class="fa-solid fa-play ml-0.5 text-lg"></i>
            </button>
            <button class="btn-next player-ctrl-btn">
                <i class="fa-solid fa-forward-step text-lg"></i>
            </button>
        </div>

        <div class="w-full flex items-center gap-3">
            <span id="p-current-time" class="text-[10px] text-slate-500 w-8 text-right font-mono">0:00</span>
            <div id="p-progress-container" class="flex-1 h-1 bg-slate-200 dark:bg-slate-700 rounded-full cursor-pointer relative group">
                <div id="p-progress" class="h-full bg-indigo-500 w-0 rounded-full relative transition-all duration-100">
                    <div class="absolute right-0 top-1/2 -translate-y-1/2 w-3 h-3 bg-white border border-indigo-500 rounded-full scale-0 group-hover:scale-100 transition-transform shadow-md"></div>
                </div>
            </div>
            <span id="p-total-time" class="text-[10px] text-slate-500 w-8 font-mono">0:00</span>
        </div>
    </div>

    <!-- 1 -->
    <div class="flex items-center justify-end gap-5 w-1/3">
        <!-- <div class="flex items-center gap-3 group">
            <i class="fa-solid fa-volume-low text-slate-500"></i>
            <div id="volume-container" class="w-24 h-1 bg-slate-200 dark:bg-slate-700 rounded-full cursor-pointer relative overflow-hidden">
                <div id="volume-progress" class="absolute h-full bg-slate-400 w-2/3 group-hover:bg-indigo-400 transition-colors"></div>
            </div>
        </div> -->
        <!-- <button class="text-slate-500 hover:text-indigo-500 transition text-sm"><i class="fa-solid fa-list-ul"></i></button> -->
        <!-- <button onclick="Player.toggleQueue()" class="text-slate-500 hover:text-indigo-500 transition text-sm">
            <i class="fa-solid fa-list-ul"></i>
        </button> -->
        <div class="flex items-center gap-3 group">
            <button onclick="Player.toggleMute()" class="flex items-center justify-center">
                <i id="fp-volume-icon" class="fa-solid fa-volume-low text-slate-500 text-lg group-hover:text-indigo-500 transition-all"></i>
            </button>
            <div id="volume-container" class="w-24 h-1.5 bg-slate-200 dark:bg-slate-700 rounded-full cursor-pointer relative overflow-hidden">
                <div id="volume-progress" class="absolute h-full bg-slate-400 w-2/3 group-hover:bg-indigo-400 transition-colors"></div>
            </div>
        </div>
        <button onclick="Player.toggleQueue()" class="text-slate-500 hover:text-indigo-500 transition text-sm">
            <i class="fa-solid fa-list-ul"></i>
        </button>
    </div>
    </div>

    <div id="user-settings-modal" class="fixed inset-0 z-[110] hidden">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="toggleSettings()"></div>
    
    <div id="settings-panel" class="absolute right-0 top-0 h-full w-[400px] bg-slate-900 border-l border-white/5 shadow-2xl p-8 flex flex-col overflow-y-auto transform transition-transform duration-300 translate-x-full">
        
        <div class="flex items-center justify-between mb-10">
            <h2 class="text-2xl font-bold tracking-tight text-white">账户与偏好</h2>
            <button onclick="toggleSettings()" class="text-slate-400 hover:text-white transition">
                <i class="fa-solid fa-xmark text-xl"></i>
            </button>
        </div>

        <section class="mb-10">
            <h3 class="text-[10px] font-semibold text-slate-500 uppercase tracking-widest mb-4">身份识别身份识别 IDENTITY</h3>
            <div class="space-y-6">
                <div>
                    <label class="text-xs text-slate-500 mb-2 block font-medium">通过 UID 获取新凭证</label>
                    
                    <div class="flex gap-2">
                        <input type="text" id="uid-input" placeholder="输入用户 UID" 
                            class="dynamic-input flex-1 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-indigo-500 transition">
                        <button onclick="fetchNewCookie()" id="btn-get-uid" 
                            class="btn-secondary px-3 py-2 rounded-lg text-xs transition-all font-medium">获取</button>
                    </div>
                </div>

                <div>
                    <label class="text-xs text-slate-500 mb-2 block font-medium">使用 Cookie 凭证登录</label>
                    
                    <div class="flex flex-col gap-2">
                        <input type="password" id="cookie-input" placeholder="输入您的凭证 (Cookie)" 
                            class="dynamic-input w-full rounded-lg px-4 py-2 text-sm font-mono focus:outline-none focus:border-emerald-500 transition text-emerald-400">
                        <button onclick="handleCookieLogin()" 
                                class="dynamic-button-primary w-full py-2 rounded-lg text-sm transition font-bold text-white shadow-lg">验证并登录</button>
                    </div>
                </div>

                <div id="login-status-box" class="p-4 bg-white/5 rounded-xl border border-white/5 transition-all">
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-slate-500">当前会话状态</span>
                        <span id="current-session-label" class="text-[10px] font-bold px-2 py-0.5 rounded bg-red-500/10 text-red-400">未登录</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-6">
            <h3 class="text-[10px] font-semibold text-slate-500 uppercase tracking-widest mb-4">个性化与支持</h3>
            <div class="space-y-4">
                <div class="flex items-center justify-between p-3 dynamic-input rounded-xl mb-4">
                    <div>
                        <p class="text-sm font-medium">主题模式</p>
                        <p class="text-[10px] text-slate-500">自适应视觉风格</p>
                    </div>
                    <div class="flex toggle-base p-1 rounded-lg relative transition-all duration-300">
                        <button onclick="setTheme('dark')" id="btn-dark" class="relative z-10 w-10 h-8 flex items-center justify-center rounded-md text-white">
                        <i class="fa-solid fa-moon text-xs"></i>
                        </button>
                        <button onclick="setTheme('light')" id="btn-light" class="relative z-10 w-10 h-8 flex items-center justify-center rounded-md text-slate-500">
                        <i class="fa-solid fa-sun text-xs"></i>
                        </button>
                        <div id="theme-slider" class="absolute top-1 left-1 w-10 h-8 bg-indigo-600 rounded-md transition-all duration-300 ease-out shadow-sm"></div>
                    </div>
                </div>
                <div class="flex items-center justify-between p-3 dynamic-input rounded-xl mb-4">
                <div>
                    <p class="text-sm font-medium">智能推荐</p>
                    <p class="text-[10px] text-slate-500">基于播放历史推荐歌曲</p>
                </div>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="recommend-checkbox" checked class="sr-only peer">
                    <div class="switch-track w-9 h-5 bg-slate-300 dark:bg-slate-700 rounded-full transition-all 
                    after:content-[''] after:absolute after:top-[2px] after:left-[2px] 
                    after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all 
                    peer-checked:after:translate-x-full"></div>
                </label>
                </div>
                <a href="https://github.com/13776578253-glitch/music_player" target="_blank" 
                   class="flex items-center justify-between p-3 bg-white/5 hover:bg-white/10 rounded-xl transition-all group border border-white/5">
                    <div class="flex items-center gap-3">
                        <i class="fa-brands fa-github text-xl text-slate-400 group-hover:text-white"></i>
                        <div>
                            <p class="text-sm font-medium text-white">开源项目</p>
                            <p class="text-[10px] text-slate-500">访问 GitHub 仓库</p>
                        </div>
                    </div>
                    <i class="fa-solid fa-arrow-up-right-from-square text-[10px] text-slate-600 group-hover:text-indigo-400"></i>
                </a>
            </div>
        </section>

        <div class="mt-auto pt-6 text-center">
            <p class="text-[10px] text-slate-600 font-mono tracking-widest">MUSEFLOW KERNEL V1.0.4-STABLE</p>
        </div>
    </div>

    <script src="./src/js/LinkedList.js"></script>
    <script type="module" src="./src/js/api.js"></script>    
    <script src="./src/js/player.js"></script> 
    <script src="./src/js/router.js"></script>
    <script src="./src/pages/setting.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            loadPage('home');
        });
    </script>

    <!-- 测试 -->
    <!-- <script>
        // 模拟点击了歌曲列表
        window.onload = () => {
            console.log("页面已加载，3秒后将自动填充数据进行测试...");
            setTimeout(() => {
                handlePlay("1"); // 自动触发 id 为 1 的歌曲
            }, 3000);
        }
    </script> -->
</body>
</html>